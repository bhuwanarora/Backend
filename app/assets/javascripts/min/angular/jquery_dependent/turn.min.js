!function(a){function b(a,b,c){if(!c[0]||"object"==typeof c[0])return b.init.apply(a,c);if(b[c[0]])return b[c[0]].apply(a,Array.prototype.slice.call(c,1));throw l(c[0]+" is not a method or property")}function c(a,b,c,d){return{css:{position:"absolute",top:a,left:b,overflow:d||"hidden",zIndex:c||"auto"}}}function d(a,b,c,d,f){var g=1-f,h=g*g*g,i=f*f*f;return e(Math.round(h*a.x+3*f*g*g*b.x+3*f*f*g*c.x+i*d.x),Math.round(h*a.y+3*f*g*g*b.y+3*f*f*g*c.y+i*d.y))}function e(a,b){return{x:a,y:b}}function f(a,b,c){return n&&c?" translate3d("+a+"px,"+b+"px, 0px) ":" translate("+a+"px, "+b+"px) "}function g(a){return" rotate("+a+"deg) "}function h(a,b){return Object.prototype.hasOwnProperty.call(b,a)}function i(){for(var a=["Moz","Webkit","Khtml","O","ms"],b=a.length,c="";b--;)a[b]+"Transform"in document.body.style&&(c="-"+a[b].toLowerCase()+"-");return c}function j(a,b,c,d,f){var g,h=[];if("-webkit-"==p){for(g=0;f>g;g++)h.push("color-stop("+d[g][0]+", "+d[g][1]+")");a.css({"background-image":"-webkit-gradient(linear, "+b.x+"% "+b.y+"%,"+c.x+"% "+c.y+"%, "+h.join(",")+" )"})}else{var b={x:b.x/100*a.width(),y:b.y/100*a.height()},c={x:c.x/100*a.width(),y:c.y/100*a.height()},i=c.x-b.x;g=c.y-b.y;var j=Math.atan2(g,i),k=j-Math.PI/2,k=Math.abs(a.width()*Math.sin(k))+Math.abs(a.height()*Math.cos(k)),i=Math.sqrt(g*g+i*i),c=e(c.x<b.x?a.width():0,c.y<b.y?a.height():0),l=Math.tan(j);for(g=-1/l,l=(g*c.x-c.y-l*b.x+b.y)/(g-l),c=g*l-g*c.x+c.y,b=Math.sqrt(Math.pow(l-b.x,2)+Math.pow(c-b.y,2)),g=0;f>g;g++)h.push(" "+d[g][1]+" "+100*(b+i*d[g][0])/k+"%");a.css({"background-image":p+"linear-gradient("+-j+"rad,"+h.join(",")+")"})}}function k(b,c,d){return b=a.Event(b),c.trigger(b,d),b.isDefaultPrevented()?"prevented":b.isPropagationStopped()?"stopped":""}function l(a){function b(a){this.name="TurnJsError",this.message=a}return b.prototype=Error(),b.prototype.constructor=b,new b(a)}function m(a){var b={top:0,left:0};do b.left+=a.offsetLeft,b.top+=a.offsetTop;while(a=a.offsetParent);return b}var n,o,p="",q=Math.PI,r=q/2,s="ontouchstart"in window,t=s?{down:"touchstart",move:"touchmove",up:"touchend",over:"touchstart",out:"touchend"}:{down:"mousedown",move:"mousemove",up:"mouseup",over:"mouseover",out:"mouseout"},u={backward:["bl","tl"],forward:["br","tr"],all:"tl bl tr br l r".split(" ")},v=["single","double"],w=["ltr","rtl"],x={acceleration:!0,display:"double",duration:600,page:1,gradients:!0,turnCorners:"bl,br",when:null},y={cornerSize:100},z={init:function(b){n="WebKitCSSMatrix"in window||"MozPerspective"in document.body.style;var c;o=(c=/AppleWebkit\/([0-9\.]+)/i.exec(navigator.userAgent))?534.3<parseFloat(c[1]):!0,p=i();var d;c=0;var e=this.data(),g=this.children(),b=a.extend({width:this.width(),height:this.height(),direction:this.attr("dir")||this.css("direction")||"ltr"},x,b);if(e.opts=b,e.pageObjs={},e.pages={},e.pageWrap={},e.pageZoom={},e.pagePlace={},e.pageMv=[],e.zoom=1,e.totalPages=b.pages||0,e.eventHandlers={touchStart:a.proxy(z._touchStart,this),touchMove:a.proxy(z._touchMove,this),touchEnd:a.proxy(z._touchEnd,this),start:a.proxy(z._eventStart,this)},b.when)for(d in b.when)h(d,b.when)&&this.bind(d,b.when[d]);for(this.css({position:"relative",width:b.width,height:b.height}),this.turn("display",b.display),""!==b.direction&&this.turn("direction",b.direction),n&&!s&&b.acceleration&&this.transform(f(0,0,!0)),d=0;d<g.length;d++)"1"!=a(g[d]).attr("ignore")&&this.turn("addPage",g[d],++c);return a(this).bind(t.down,e.eventHandlers.touchStart).bind("end",z._eventEnd).bind("pressed",z._eventPressed).bind("released",z._eventReleased).bind("flip",z._flip),a(this).parent().bind("start",e.eventHandlers.start),a(document).bind(t.move,e.eventHandlers.touchMove).bind(t.up,e.eventHandlers.touchEnd),this.turn("page",b.page),e.done=!0,this},addPage:function(b,c){var d,e=!1,f=this.data(),g=f.totalPages+1;if(f.destroying)return!1;if((d=/\bp([0-9]+)\b/.exec(a(b).attr("class")))&&(c=parseInt(d[1],10)),c){if(c==g)e=!0;else if(c>g)throw l('Page "'+c+'" cannot be inserted')}else c=g,e=!0;return c>=1&&g>=c&&(d="double"==f.display?c%2?" odd":" even":"",f.done&&this.turn("stop"),c in f.pageObjs&&z._movePages.call(this,c,1),e&&(f.totalPages=g),f.pageObjs[c]=a(b).css({"float":"left"}).addClass("page p"+c+d),-1!=navigator.userAgent.indexOf("MSIE 9.0")&&f.pageObjs[c].hasClass("hard")&&f.pageObjs[c].removeClass("hard"),z._addPage.call(this,c),z._removeFromDOM.call(this)),this},_addPage:function(b){var c=this.data(),d=c.pageObjs[b];if(d)if(z._necessPage.call(this,b)){if(!c.pageWrap[b]){c.pageWrap[b]=a("<div/>",{"class":"page-wrapper",page:b,css:{position:"absolute",overflow:"hidden"}}),this.append(c.pageWrap[b]),c.pagePlace[b]||(c.pagePlace[b]=b,c.pageObjs[b].appendTo(c.pageWrap[b]));var e=z._pageSize.call(this,b,!0);d.css({width:e.width,height:e.height}),c.pageWrap[b].css(e)}c.pagePlace[b]==b&&z._makeFlip.call(this,b)}else c.pagePlace[b]=0,c.pageObjs[b]&&c.pageObjs[b].remove()},hasPage:function(a){return h(a,this.data().pageObjs)},center:function(b){var c=this.data(),d=a(this).turn("size"),e=0;return c.noCenter||("double"==c.display&&(b=this.turn("view",b||c.tpage||c.page),"ltr"==c.direction?b[0]?b[1]||(e+=d.width/4):e-=d.width/4:b[0]?b[1]||(e-=d.width/4):e+=d.width/4),a(this).css({marginLeft:e})),this},destroy:function(){var b=this,c=this.data(),d="end first flip last pressed released start turning turned zooming missing".split(" ");if("prevented"!=k("destroying",this)){for(c.destroying=!0,a.each(d,function(a,c){b.unbind(c)}),this.parent().unbind("start",c.eventHandlers.start),a(document).unbind(t.move,c.eventHandlers.touchMove).unbind(t.up,c.eventHandlers.touchEnd);0!==c.totalPages;)this.turn("removePage",c.totalPages);return c.fparent&&c.fparent.remove(),c.shadow&&c.shadow.remove(),this.removeData(),c=null,this}},is:function(){return"object"==typeof this.data().pages},zoom:function(b){var c=this.data();if("number"==typeof b){if(.001>b||b>100)throw l(b+" is not a value for zoom");if("prevented"==k("zooming",this,[b,c.zoom]))return this;var d=this.turn("size"),e=this.turn("view"),f=1/c.zoom,g=Math.round(d.width*f*b),d=Math.round(d.height*f*b);for(c.zoom=b,a(this).turn("stop").turn("size",g,d),c.opts.autoCenter&&this.turn("center"),z._updateShadow.call(this),b=0;b<e.length;b++)e[b]&&c.pageZoom[e[b]]!=c.zoom&&(this.trigger("zoomed",[e[b],e,c.pageZoom[e[b]],c.zoom]),c.pageZoom[e[b]]=c.zoom);return this}return c.zoom},_pageSize:function(a,b){var c=this.data(),d={};if("single"==c.display)d.width=this.width(),d.height=this.height(),b&&(d.top=0,d.left=0,d.right="auto");else{var e=this.width()/2,f=this.height();if(c.pageObjs[a].hasClass("own-size")?(d.width=c.pageObjs[a].width(),d.height=c.pageObjs[a].height()):(d.width=e,d.height=f),b){var g=a%2;d.top=(f-d.height)/2,"ltr"==c.direction?(d[g?"right":"left"]=e-d.width,d[g?"left":"right"]="auto"):(d[g?"left":"right"]=e-d.width,d[g?"right":"left"]="auto")}}return d},_makeFlip:function(a){var b=this.data();if(!b.pages[a]&&b.pagePlace[a]==a){var c="single"==b.display,d=a%2;b.pages[a]=b.pageObjs[a].css(z._pageSize.call(this,a)).flip({page:a,next:d||c?a+1:a-1,turn:this}).flip("disable",b.disabled),z._setPageLoc.call(this,a),b.pageZoom[a]=b.zoom}return b.pages[a]},_makeRange:function(){var a,b;if(!(1>this.data().totalPages))for(b=this.turn("range"),a=b[0];a<=b[1];a++)z._addPage.call(this,a)},range:function(a){var b,c,d,e=this.data(),a=a||e.tpage||e.page||1;if(d=z._view.call(this,a),1>a||a>e.totalPages)throw l('"'+a+'" is not a valid page');return d[1]=d[1]||d[0],1<=d[0]&&d[1]<=e.totalPages?(a=Math.floor(2),e.totalPages-d[1]>d[0]?(b=Math.min(d[0]-1,a),c=2*a-b):(c=Math.min(e.totalPages-d[1],a),b=2*a-c)):c=b=5,[Math.max(1,d[0]-b),Math.min(e.totalPages,d[1]+c)]},_necessPage:function(a){if(0===a)return!0;var b=this.turn("range");return this.data().pageObjs[a].hasClass("fixed")||a>=b[0]&&a<=b[1]},_removeFromDOM:function(){var a,b=this.data();for(a in b.pageWrap)h(a,b.pageWrap)&&!z._necessPage.call(this,a)&&z._removePageFromDOM.call(this,a)},_removePageFromDOM:function(a){var b=this.data();if(b.pages[a]){var c=b.pages[a].data();A._moveFoldingPage.call(b.pages[a],!1),c.f&&c.f.fwrapper&&c.f.fwrapper.remove(),b.pages[a].removeData(),b.pages[a].remove(),delete b.pages[a]}b.pageObjs[a]&&b.pageObjs[a].remove(),b.pageWrap[a]&&(b.pageWrap[a].remove(),delete b.pageWrap[a]),z._removeMv.call(this,a),delete b.pagePlace[a],delete b.pageZoom[a]},removePage:function(a){var b=this.data();if("*"==a)for(;0!==b.totalPages;)this.turn("removePage",b.totalPages);else{if(1>a||a>b.totalPages)throw l("The page "+a+" doesn't exist");b.pageObjs[a]&&(this.turn("stop"),z._removePageFromDOM.call(this,a),delete b.pageObjs[a]),z._movePages.call(this,a,-1),b.totalPages-=1,b.page>b.totalPages?(b.page=null,z._fitPage.call(this,b.totalPages)):(z._makeRange.call(this),this.turn("update"))}return this},_movePages:function(a,b){var c,d=this,e=this.data(),f="single"==e.display,g=function(a){var c=a+b,g=c%2,h=g?" odd ":" even ";e.pageObjs[a]&&(e.pageObjs[c]=e.pageObjs[a].removeClass("p"+a+" odd even").addClass("p"+c+h)),e.pagePlace[a]&&e.pageWrap[a]&&(e.pagePlace[c]=c,e.pageWrap[c]=e.pageObjs[c].hasClass("fixed")?e.pageWrap[a].attr("page",c):e.pageWrap[a].css(z._pageSize.call(d,c,!0)).attr("page",c),e.pages[a]&&(e.pages[c]=e.pages[a].flip("options",{page:c,next:f||g?c+1:c-1})),b&&(delete e.pages[a],delete e.pagePlace[a],delete e.pageZoom[a],delete e.pageObjs[a],delete e.pageWrap[a]))};if(b>0)for(c=e.totalPages;c>=a;c--)g(c);else for(c=a;c<=e.totalPages;c++)g(c)},display:function(b){var c=this.data(),d=c.display;if(void 0===b)return d;if(-1==a.inArray(b,v))throw l('"'+b+'" is not a value for display');switch(b){case"single":c.pageObjs[0]||(this.turn("stop").css({overflow:"hidden"}),c.pageObjs[0]=a("<div />",{"class":"page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)),this.addClass("shadow");break;case"double":c.pageObjs[0]&&(this.turn("stop").css({overflow:""}),c.pageObjs[0].remove(),delete c.pageObjs[0]),this.removeClass("shadow")}return c.display=b,d&&(b=this.turn("size"),z._movePages.call(this,1,0),this.turn("size",b.width,b.height).turn("update")),this},direction:function(b){var c=this.data();if(void 0===b)return c.direction;if(b=b.toLowerCase(),-1==a.inArray(b,w))throw l('"'+b+'" is not a value for direction');return"rtl"==b&&a(this).attr("dir","ltr").css({direction:"ltr"}),c.direction=b,c.done&&this.turn("size",a(this).width(),a(this).height()),this},animating:function(){return 0<this.data().pageMv.length},corner:function(){var a,b,c=this.data();for(b in c.pages)if(h(b,c.pages)&&(a=c.pages[b].flip("corner")))return a;return!1},data:function(){return this.data()},disable:function(b){var c,d=this.data(),e=this.turn("view");d.disabled=void 0===b||!0===b;for(c in d.pages)h(c,d.pages)&&d.pages[c].flip("disable",d.disabled?!0:-1==a.inArray(parseInt(c,10),e));return this},disabled:function(a){return void 0===a?!0===this.data().disabled:this.turn("disable",a)},size:function(a,b){if(void 0===a||void 0===b)return{width:this.width(),height:this.height()};this.turn("stop");var c,d,e=this.data();d="double"==e.display?a/2:a,this.css({width:a,height:b}),e.pageObjs[0]&&e.pageObjs[0].css({width:d,height:b});for(c in e.pageWrap)h(c,e.pageWrap)&&(d=z._pageSize.call(this,c,!0),e.pageObjs[c].css({width:d.width,height:d.height}),e.pageWrap[c].css(d),e.pages[c]&&e.pages[c].css({width:d.width,height:d.height}));return this.turn("resize"),this},resize:function(){var a,b=this.data();for(b.pages[0]&&(b.pageWrap[0].css({left:-this.width()}),b.pages[0].flip("resize",!0)),a=1;a<=b.totalPages;a++)b.pages[a]&&b.pages[a].flip("resize",!0);z._updateShadow.call(this),b.opts.autoCenter&&this.turn("center")},_removeMv:function(a){var b,c=this.data();for(b=0;b<c.pageMv.length;b++)if(c.pageMv[b]==a)return c.pageMv.splice(b,1),!0;return!1},_addMv:function(a){var b=this.data();z._removeMv.call(this,a),b.pageMv.push(a)},_view:function(a){var b=this.data(),a=a||b.page;return"double"==b.display?a%2?[a-1,a]:[a,a+1]:[a]},view:function(a){var b=this.data(),a=z._view.call(this,a);return"double"==b.display?[0<a[0]?a[0]:0,a[1]<=b.totalPages?a[1]:0]:[0<a[0]&&a[0]<=b.totalPages?a[0]:0]},stop:function(a,b){if(this.turn("animating")){var c,d,e,f=this.data();for(f.tpage&&(f.page=f.tpage,delete f.tpage),c=0;c<f.pageMv.length;c++)f.pageMv[c]&&f.pageMv[c]!==a&&(e=f.pages[f.pageMv[c]],d=e.data().f.opts,e.flip("hideFoldedPage",b),b||A._moveFoldingPage.call(e,!1),d.force&&(d.next=0===d.page%2?d.page-1:d.page+1,delete d.force))}return this.turn("update"),this},pages:function(a){var b=this.data();if(a){if(a<b.totalPages)for(var c=b.totalPages;c>a;c--)this.turn("removePage",c);return b.totalPages=a,z._fitPage.call(this,b.page),this}return b.totalPages},_missing:function(a){var b=this.data();if(!(1>b.totalPages)){for(var c=this.turn("range",a),d=[],a=c[0];a<=c[1];a++)b.pageObjs[a]||d.push(a);0<d.length&&this.trigger("missing",[d])}},_fitPage:function(a){var b=this.data(),c=this.turn("view",a);if(z._missing.call(this,a),b.pageObjs[a]){b.page=a,this.turn("stop");for(var d=0;d<c.length;d++)c[d]&&b.pageZoom[c[d]]!=b.zoom&&(this.trigger("zoomed",[c[d],c,b.pageZoom[c[d]],b.zoom]),b.pageZoom[c[d]]=b.zoom);z._removeFromDOM.call(this),z._makeRange.call(this),z._updateShadow.call(this),this.trigger("turned",[a,c]),this.turn("update"),b.opts.autoCenter&&this.turn("center")}},_turnPage:function(b){var c,d,e=this.data(),f=e.pagePlace[b],g=this.turn("view"),h=this.turn("view",b);if(e.page!=b){var i=e.page;if("prevented"==k("turning",this,[b,h]))return void(i==e.page&&-1!=a.inArray(f,e.pageMv)&&e.pages[f].flip("hideFoldedPage",!0));-1!=a.inArray(1,h)&&this.trigger("first"),-1!=a.inArray(e.totalPages,h)&&this.trigger("last")}"single"==e.display?(c=g[0],d=h[0]):g[1]&&b>g[1]?(c=g[1],d=h[0]):g[0]&&b<g[0]&&(c=g[0],d=h[1]),f=e.opts.turnCorners.split(","),g=e.pages[c].data().f,h=g.opts,i=g.point,z._missing.call(this,b),e.pageObjs[b]&&(this.turn("stop"),e.page=b,z._makeRange.call(this),e.tpage=d,h.next!=d&&(h.next=d,h.force=!0),this.turn("update"),g.point=i,"hard"==g.effect?"ltr"==e.direction?e.pages[c].flip("turnPage",b>c?"r":"l"):e.pages[c].flip("turnPage",b>c?"l":"r"):"ltr"==e.direction?e.pages[c].flip("turnPage",f[b>c?1:0]):e.pages[c].flip("turnPage",f[b>c?0:1]))},page:function(b){var c=this.data();if(void 0===b)return c.page;if(!c.disabled&&!c.destroying){if(b=parseInt(b,10),b>0&&b<=c.totalPages)return b!=c.page&&(c.done&&-1==a.inArray(b,this.turn("view"))?z._turnPage.call(this,b):z._fitPage.call(this,b)),this;throw l("The page "+b+" does not exist")}},next:function(){return this.turn("page",Math.min(this.data().totalPages,z._view.call(this,this.data().page).pop()+1))},previous:function(){return this.turn("page",Math.max(1,z._view.call(this,this.data().page).shift()-1))},peel:function(a,b){var c=this.data(),d=this.turn("view"),b=void 0===b?!0:!0===b;return!1===a?this.turn("stop",null,b):"single"==c.display?c.pages[c.page].flip("peel",a,b):(d="ltr"==c.direction?-1!=a.indexOf("l")?d[0]:d[1]:-1!=a.indexOf("l")?d[1]:d[0],c.pages[d]&&c.pages[d].flip("peel",a,b)),this},_addMotionPage:function(){var b=a(this).data().f.opts,c=b.turn;c.data(),z._addMv.call(c,b.page)},_eventStart:function(a,b,c){var d=b.turn.data(),e=d.pageZoom[b.page];a.isDefaultPrevented()||(e&&e!=d.zoom&&(b.turn.trigger("zoomed",[b.page,b.turn.turn("view",b.page),e,d.zoom]),d.pageZoom[b.page]=d.zoom),"single"==d.display&&c&&("l"==c.charAt(1)&&"ltr"==d.direction||"r"==c.charAt(1)&&"rtl"==d.direction?(b.next=b.next<b.page?b.next:b.page-1,b.force=!0):b.next=b.next>b.page?b.next:b.page+1),z._addMotionPage.call(a.target)),z._updateShadow.call(b.turn)},_eventEnd:function(b,c,d){a(b.target).data();var b=c.turn,e=b.data();d?(d=e.tpage||e.page,(d==c.next||d==c.page)&&(delete e.tpage,z._fitPage.call(b,d||c.next,!0))):(z._removeMv.call(b,c.page),z._updateShadow.call(b),b.turn("update"))},_eventPressed:function(b){var b=a(b.target).data().f,c=b.opts.turn;return c.data().mouseAction=!0,c.turn("update"),b.time=(new Date).getTime()},_eventReleased:function(b,c){var d;d=a(b.target);var e=d.data().f,f=e.opts.turn,g=f.data();d="single"==g.display?"br"==c.corner||"tr"==c.corner?c.x<d.width()/2:c.x>d.width()/2:0>c.x||c.x>d.width(),(200>(new Date).getTime()-e.time||d)&&(b.preventDefault(),z._turnPage.call(f,e.opts.next)),g.mouseAction=!1},_flip:function(b){b.stopPropagation(),b=a(b.target).data().f.opts,b.turn.trigger("turn",[b.next]),b.turn.data().opts.autoCenter&&b.turn.turn("center",b.next)},_touchStart:function(){var a,b=this.data();for(a in b.pages)if(h(a,b.pages)&&!1===A._eventStart.apply(b.pages[a],arguments))return!1},_touchMove:function(){var a,b=this.data();for(a in b.pages)h(a,b.pages)&&A._eventMove.apply(b.pages[a],arguments)},_touchEnd:function(){var a,b=this.data();for(a in b.pages)h(a,b.pages)&&A._eventEnd.apply(b.pages[a],arguments)},calculateZ:function(a){var b,c,d,e,f=this,g=this.data();b=this.turn("view");var h=b[0]||b[1],i=a.length-1,j={pageZ:{},partZ:{},pageV:{}},k=function(a){a=f.turn("view",a),a[0]&&(j.pageV[a[0]]=!0),a[1]&&(j.pageV[a[1]]=!0)};for(b=0;i>=b;b++)c=a[b],d=g.pages[c].data().f.opts.next,e=g.pagePlace[c],k(c),k(d),c=g.pagePlace[d]==d?d:c,j.pageZ[c]=g.totalPages-Math.abs(h-c),j.partZ[e]=2*g.totalPages-i+b;return j},update:function(){var b,c=this.data();if(this.turn("animating")&&0!==c.pageMv[0]){var d,e=this.turn("calculateZ",c.pageMv),f=this.turn("corner"),g=this.turn("view"),i=this.turn("view",c.tpage);for(b in c.pageWrap)h(b,c.pageWrap)&&(d=c.pageObjs[b].hasClass("fixed"),c.pageWrap[b].css({display:e.pageV[b]||d?"":"none",zIndex:(c.pageObjs[b].hasClass("hard")?e.partZ[b]:e.pageZ[b])||(d?-1:0)}),d=c.pages[b])&&(d.flip("z",e.partZ[b]||null),e.pageV[b]&&d.flip("resize"),c.tpage?d.flip("hover",!1).flip("disable",-1==a.inArray(parseInt(b,10),c.pageMv)&&b!=i[0]&&b!=i[1]):d.flip("hover",!1===f).flip("disable",b!=g[0]&&b!=g[1]))}else for(b in c.pageWrap)h(b,c.pageWrap)&&(e=z._setPageLoc.call(this,b),c.pages[b]&&c.pages[b].flip("disable",c.disabled||1!=e).flip("hover",!0).flip("z",null));return this},_updateShadow:function(){var b,d,e=this.data(),f=this.width(),g=this.height(),h="single"==e.display?f:f/2;b=this.turn("view"),e.shadow||(e.shadow=a("<div />",{"class":"shadow",css:c(0,0,0).css}).appendTo(this));for(var i=0;i<e.pageMv.length&&b[0]&&b[1];i++)b=this.turn("view",e.pages[e.pageMv[i]].data().f.opts.next),d=this.turn("view",e.pageMv[i]),b[0]=b[0]&&d[0],b[1]=b[1]&&d[1];switch(b[0]?b[1]?3:"ltr"==e.direction?2:1:"ltr"==e.direction?1:2){case 1:e.shadow.css({width:h,height:g,top:0,left:h});break;case 2:e.shadow.css({width:h,height:g,top:0,left:0});break;case 3:e.shadow.css({width:f,height:g,top:0,left:0})}},_setPageLoc:function(a){var b=this.data(),c=this.turn("view"),d=0;if(a==c[0]||a==c[1]?d=1:("single"==b.display&&a==c[0]+1||"double"==b.display&&a==c[0]-2||a==c[1]+2)&&(d=2),!this.turn("animating"))switch(d){case 1:b.pageWrap[a].css({zIndex:b.totalPages,display:""});break;case 2:b.pageWrap[a].css({zIndex:b.totalPages-1,display:""});break;case 0:b.pageWrap[a].css({zIndex:0,display:b.pageObjs[a].hasClass("fixed")?"":"none"})}return d},options:function(b){if(void 0===b)return this.data().opts;var c=this.data();if(a.extend(c.opts,b),b.pages&&this.turn("pages",b.pages),b.page&&this.turn("page",b.page),b.display&&this.turn("display",b.display),b.direction&&this.turn("direction",b.direction),b.width&&b.height&&this.turn("size",b.width,b.height),b.when)for(var d in b.when)h(d,b.when)&&this.unbind(d).bind(d,b.when[d]);return this},version:function(){return"4.1.0"}},A={init:function(a){return this.data({f:{disabled:!1,hover:!1,effect:this.hasClass("hard")?"hard":"sheet"}}),this.flip("options",a),A._addPageWrapper.call(this),this},setData:function(b){var c=this.data();return c.f=a.extend(c.f,b),this},options:function(b){var c=this.data().f;return b?(A.setData.call(this,{opts:a.extend({},c.opts||y,b)}),this):c.opts},z:function(a){var b=this.data().f;return b.opts["z-index"]=a,b.fwrapper&&b.fwrapper.css({zIndex:a||parseInt(b.parent.css("z-index"),10)||0}),this},_cAllowed:function(){var a=this.data().f,b=a.opts.page,c=a.opts.turn.data(),d=b%2;return"hard"==a.effect?"ltr"==c.direction?[d?"r":"l"]:[d?"l":"r"]:"single"==c.display?1==b?"ltr"==c.direction?u.forward:u.backward:b==c.totalPages?"ltr"==c.direction?u.backward:u.forward:u.all:"ltr"==c.direction?u[d?"forward":"backward"]:u[d?"backward":"forward"]},_cornerActivated:function(b){var c=this.data().f,d=this.width(),e=this.height(),b={x:b.x,y:b.y,corner:""},f=c.opts.cornerSize;if(0>=b.x||0>=b.y||b.x>=d||b.y>=e)return!1;var g=A._cAllowed.call(this);switch(c.effect){case"hard":if(b.x>d-f)b.corner="r";else{if(!(b.x<f))return!1;b.corner="l"}break;case"sheet":if(b.y<f)b.corner+="t";else{if(!(b.y>=e-f))return!1;b.corner+="b"}if(b.x<=f)b.corner+="l";else{if(!(b.x>=d-f))return!1;b.corner+="r"}}return b.corner&&-1!=a.inArray(b.corner,g)?b:!1},_isIArea:function(a){var b=this.data().f.parent.offset(),a=s&&a.originalEvent?a.originalEvent.touches[0]:a;return A._cornerActivated.call(this,{x:a.pageX-b.left,y:a.pageY-b.top})},_c:function(a,b){switch(b=b||0,a){case"tl":return e(b,b);case"tr":return e(this.width()-b,b);case"bl":return e(b,this.height()-b);case"br":return e(this.width()-b,this.height()-b);case"l":return e(b,0);case"r":return e(this.width()-b,0)}},_c2:function(a){switch(a){case"tl":return e(2*this.width(),0);case"tr":return e(-this.width(),0);case"bl":return e(2*this.width(),this.height());case"br":return e(-this.width(),this.height());case"l":return e(2*this.width(),0);case"r":return e(-this.width(),0)}},_foldingPage:function(){var a=this.data().f;if(a){var b=a.opts;if(b.turn)return a=b.turn.data(),"single"==a.display?1<b.next||1<b.page?a.pageObjs[0]:null:a.pageObjs[b.next]}},_backGradient:function(){var b=this.data().f,d=b.opts.turn.data();return(d=d.opts.gradients&&("single"==d.display||2!=b.opts.page&&b.opts.page!=d.totalPages-1))&&!b.bshadow&&(b.bshadow=a("<div/>",c(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(b.parent)),d},type:function(){return this.data().f.effect},resize:function(a){var b=this.data().f,c=b.opts.turn.data(),d=this.width(),e=this.height();switch(b.effect){case"hard":a&&(b.wrapper.css({width:d,height:e}),b.fpage.css({width:d,height:e}),c.opts.gradients&&(b.ashadow.css({width:d,height:e}),b.bshadow.css({width:d,height:e})));break;case"sheet":a&&(a=Math.round(Math.sqrt(Math.pow(d,2)+Math.pow(e,2))),b.wrapper.css({width:a,height:a}),b.fwrapper.css({width:a,height:a}).children(":first-child").css({width:d,height:e}),b.fpage.css({width:d,height:e}),c.opts.gradients&&b.ashadow.css({width:d,height:e}),A._backGradient.call(this)&&b.bshadow.css({width:d,height:e})),b.parent.is(":visible")&&(c=m(b.parent[0]),b.fwrapper.css({top:c.top,left:c.left}),c=m(b.opts.turn[0]),b.fparent.css({top:-c.top,left:-c.left})),this.flip("z",b.opts["z-index"])}},_addPageWrapper:function(){var b=this.data().f,d=b.opts.turn.data(),e=this.parent();if(b.parent=e,!b.wrapper)switch(b.effect){case"hard":var f={};f[p+"transform-style"]="preserve-3d",f[p+"backface-visibility"]="hidden",b.wrapper=a("<div/>",c(0,0,2)).css(f).appendTo(e).prepend(this),b.fpage=a("<div/>",c(0,0,1)).css(f).appendTo(e),d.opts.gradients&&(b.ashadow=a("<div/>",c(0,0,0)).hide().appendTo(e),b.bshadow=a("<div/>",c(0,0,0)));break;case"sheet":var f=this.width(),g=this.height();Math.round(Math.sqrt(Math.pow(f,2)+Math.pow(g,2))),b.fparent=b.opts.turn.data().fparent,b.fparent||(f=a("<div/>",{css:{"pointer-events":"none"}}).hide(),f.data().flips=0,f.css(c(0,0,"auto","visible").css).appendTo(b.opts.turn),b.opts.turn.data().fparent=f,b.fparent=f),this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"}),b.wrapper=a("<div/>",c(0,0,this.css("z-index"))).appendTo(e).prepend(this),b.fwrapper=a("<div/>",c(e.offset().top,e.offset().left)).hide().appendTo(b.fparent),b.fpage=a("<div/>",c(0,0,0,"visible")).css({cursor:"default"}).appendTo(b.fwrapper),d.opts.gradients&&(b.ashadow=a("<div/>",c(0,0,1)).appendTo(b.fpage)),A.setData.call(this,b)}A.resize.call(this,!0)},_fold:function(a){var b=this.data().f,c=b.opts.turn.data(),d=A._c.call(this,a.corner),h=this.width(),i=this.height();switch(b.effect){case"hard":a.x="l"==a.corner?Math.min(Math.max(a.x,0),2*h):Math.max(Math.min(a.x,h),-h);var k,l,m,n,s,t=c.totalPages,u=b.opts["z-index"]||t,v={overflow:"visible"},w=d.x?(d.x-a.x)/h:a.x/h,x=90*w,y=90>x;switch(a.corner){case"l":n="0% 50%",s="100% 50%",y?(k=0,l=0<b.opts.next-1,m=1):(k="100%",l=b.opts.page+1<t,m=0);break;case"r":n="100% 50%",s="0% 50%",x=-x,h=-h,y?(k=0,l=b.opts.next+1<t,m=0):(k="-100%",l=1!=b.opts.page,m=1)}v[p+"perspective-origin"]=s,b.wrapper.transform("rotateY("+x+"deg)translate3d(0px, 0px, "+(this.attr("depth")||0)+"px)",s),b.fpage.transform("translateX("+h+"px) rotateY("+(180+x)+"deg)",n),b.parent.css(v),y?(w=-w+1,b.wrapper.css({zIndex:u+1}),b.fpage.css({zIndex:u})):(w-=1,b.wrapper.css({zIndex:u}),b.fpage.css({zIndex:u+1})),c.opts.gradients&&(l?b.ashadow.css({display:"",left:k,backgroundColor:"rgba(0,0,0,"+.5*w+")"}).transform("rotateY(0deg)"):b.ashadow.hide(),b.bshadow.css({opacity:-w+1}),y?b.bshadow.parent()[0]!=b.wrapper[0]&&b.bshadow.appendTo(b.wrapper):b.bshadow.parent()[0]!=b.fpage[0]&&b.bshadow.appendTo(b.fpage),j(b.bshadow,e(100*m,0),e(100*(-m+1),0),[[0,"rgba(0,0,0,0.3)"],[1,"rgba(0,0,0,0)"]],2));break;case"sheet":var z,B,C,D,E,F,G,H=this,I=0,J=e(0,0),K=e(0,0),L=e(0,0),M=A._foldingPage.call(this);Math.tan(0);var N=c.opts.acceleration,O=b.wrapper.height(),P="t"==a.corner.substr(0,1),Q="l"==a.corner.substr(1,1),R=function(){var b=e(0,0),f=e(0,0);b.x=d.x?d.x-a.x:a.x,b.y=o?d.y?d.y-a.y:a.y:0,f.x=Q?h-b.x/2:a.x+b.x/2,f.y=b.y/2;var g=r-Math.atan2(b.y,b.x),j=g-Math.atan2(f.y,f.x),j=Math.max(0,Math.sin(j)*Math.sqrt(Math.pow(f.x,2)+Math.pow(f.y,2)));return I=180*(g/q),L=e(j*Math.sin(g),j*Math.cos(g)),g>r&&(L.x+=Math.abs(L.y*b.y/b.x),L.y=0,Math.round(L.x*Math.tan(q-g))<i)?(a.y=Math.sqrt(Math.pow(i,2)+2*f.x*b.x),P&&(a.y=i-a.y),R()):(g>r&&(b=q-g,f=O-i/Math.sin(b),J=e(Math.round(f*Math.cos(b)),Math.round(f*Math.sin(b))),Q&&(J.x=-J.x),P)&&(J.y=-J.y),z=Math.round(L.y/Math.tan(g)+L.x),b=h-z,f=b*Math.cos(2*g),j=b*Math.sin(2*g),K=e(Math.round(Q?b-f:z+f),Math.round(P?j:i-j)),c.opts.gradients&&(E=b*Math.sin(g),b=A._c2.call(H,a.corner),b=Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))/h,G=Math.sin(r*(b>1?2-b:b)),F=Math.min(b,1),D=E>100?(E-100)/E:0,B=e(100*(E*Math.sin(g)/h),100*(E*Math.cos(g)/i)),A._backGradient.call(H)&&(C=e(100*(1.2*E*Math.sin(g)/h),100*(1.2*E*Math.cos(g)/i)),Q||(C.x=100-C.x),!P))&&(C.y=100-C.y),L.x=Math.round(L.x),L.y=Math.round(L.y),!0)};switch(k=function(a,d,k,l){var m=["0","auto"],n=(h-O)*k[0]/100,o=(i-O)*k[1]/100,d={left:m[d[0]],top:m[d[1]],right:m[d[2]],bottom:m[d[3]]},m={},p=90!=l&&-90!=l?Q?-1:1:0,q=k[0]+"% "+k[1]+"%";H.css(d).transform(g(l)+f(a.x+p,a.y,N),q),b.fpage.css(d).transform(g(l)+f(a.x+K.x-J.x-h*k[0]/100,a.y+K.y-J.y-i*k[1]/100,N)+g((180/l-2)*l),q),b.wrapper.transform(f(-a.x+n-p,-a.y+o,N)+g(-l),q),b.fwrapper.transform(f(-a.x+J.x+n,-a.y+J.y+o,N)+g(-l),q),c.opts.gradients&&(k[0]&&(B.x=100-B.x),k[1]&&(B.y=100-B.y),m["box-shadow"]="0 0 20px rgba(0,0,0,"+.5*G+")",M.css(m),j(b.ashadow,e(Q?100:0,P?0:100),e(B.x,B.y),[[D,"rgba(0,0,0,0)"],[.8*(1-D)+D,"rgba(0,0,0,"+.2*F+")"],[1,"rgba(255,255,255,"+.2*F+")"]],3,0),A._backGradient.call(H)&&j(b.bshadow,e(Q?0:100,P?0:100),e(C.x,C.y),[[.6,"rgba(0,0,0,0)"],[.8,"rgba(0,0,0,"+.3*F+")"],[1,"rgba(0,0,0,0)"]],3))},a.corner){case"tl":a.x=Math.max(a.x,1),R(),k(L,[1,0,0,1],[100,0],I);break;case"tr":a.x=Math.min(a.x,h-1),R(),k(e(-L.x,L.y),[0,0,0,1],[0,0],-I);break;case"bl":a.x=Math.max(a.x,1),R(),k(e(L.x,-L.y),[1,1,0,0],[100,100],-I);break;case"br":a.x=Math.min(a.x,h-1),R(),k(e(-L.x,-L.y),[0,1,1,0],[0,100],I)}}b.point=a},_moveFoldingPage:function(a){var b=this.data().f;if(b){var c=b.opts.turn,d=c.data(),e=d.pagePlace;a?(d=b.opts.next,e[d]!=b.opts.page&&(b.folding&&A._moveFoldingPage.call(this,!1),A._foldingPage.call(this).appendTo(b.fpage),e[d]=b.opts.page,b.folding=d),c.turn("update")):b.folding&&(d.pages[b.folding]?(c=d.pages[b.folding].data().f,d.pageObjs[b.folding].appendTo(c.wrapper)):d.pageWrap[b.folding]&&d.pageObjs[b.folding].appendTo(d.pageWrap[b.folding]),b.folding in e&&(e[b.folding]=b.folding),delete b.folding)}},_showFoldedPage:function(a,b){var c=A._foldingPage.call(this),d=this.data(),e=d.f,f=e.visible;if(c){if(!(f&&e.point&&e.point.corner==a.corner||(c="hover"==e.status||"peel"==e.status||e.opts.turn.data().mouseAction?a.corner:null,f=!1,"prevented"!=k("start",this,[e.opts,c]))))return!1;if(b){var g=this,d=e.point&&e.point.corner==a.corner?e.point:A._c.call(this,a.corner,1);this.animatef({from:[d.x,d.y],to:[a.x,a.y],duration:500,frame:function(b){a.x=Math.round(b[0]),a.y=Math.round(b[1]),A._fold.call(g,a)}})}else A._fold.call(this,a),d.effect&&!d.effect.turning&&this.animatef(!1);if(!f)switch(e.effect){case"hard":e.visible=!0,A._moveFoldingPage.call(this,!0),e.fpage.show(),e.opts.shadows&&e.bshadow.show();break;case"sheet":e.visible=!0,e.fparent.show().data().flips++,A._moveFoldingPage.call(this,!0),e.fwrapper.show(),e.bshadow&&e.bshadow.show()}return!0}return!1},hide:function(){var a=this.data().f,b=a.opts.turn.data(),c=A._foldingPage.call(this);switch(a.effect){case"hard":b.opts.gradients&&(a.bshadowLoc=0,a.bshadow.remove(),a.ashadow.hide()),a.wrapper.transform(""),a.fpage.hide();break;case"sheet":0===--a.fparent.data().flips&&a.fparent.hide(),this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform(""),a.wrapper.transform(""),a.fwrapper.hide(),a.bshadow&&a.bshadow.hide(),c.transform("")}return a.visible=!1,this},hideFoldedPage:function(a){var b=this.data().f;if(b.point){var c=this,f=b.point,g=function(){b.point=null,b.status="",c.flip("hide"),c.trigger("end",[b.opts,!1])};if(a){var h=A._c.call(this,f.corner),a="t"==f.corner.substr(0,1)?Math.min(0,f.y-h.y)/2:Math.max(0,f.y-h.y)/2,i=e(f.x,f.y+a),j=e(h.x,h.y-a);this.animatef({from:0,to:1,frame:function(a){a=d(f,i,j,h,a),f.x=a.x,f.y=a.y,A._fold.call(c,f)},complete:g,duration:800,hiding:!0})}else this.animatef(!1),g()}},turnPage:function(a){var b=this,c=this.data().f,e=c.opts.turn.data(),a={corner:c.corner?c.corner.corner:a||A._cAllowed.call(this)[0]},f=c.point||A._c.call(this,a.corner,c.opts.turn?e.opts.elevation:0),g=A._c2.call(this,a.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(c){c=d(f,f,g,g,c),a.x=c.x,a.y=c.y,A._showFoldedPage.call(b,a)},complete:function(){b.trigger("end",[c.opts,!0])},duration:e.opts.duration,turning:!0}),c.corner=null},moving:function(){return"effect"in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},corner:function(){return this.data().f.corner},_eventStart:function(a){var b=this.data().f,c=b.opts.turn;if(!b.corner&&!b.disabled&&!this.flip("isTurning")&&b.opts.page==c.data().pagePlace[b.opts.page]){if(b.corner=A._isIArea.call(this,a),b.corner&&A._foldingPage.call(this))return this.trigger("pressed",[b.point]),A._showFoldedPage.call(this,b.corner),!1;b.corner=null}},_eventMove:function(a){var b=this.data().f;if(!b.disabled)if(a=s?a.originalEvent.touches:[a],b.corner){var c=b.parent.offset();b.corner.x=a[0].pageX-c.left,b.corner.y=a[0].pageY-c.top,A._showFoldedPage.call(this,b.corner)}else b.hover&&!this.data().effect&&this.is(":visible")&&((a=A._isIArea.call(this,a[0]))?("sheet"==b.effect&&2==a.corner.length||"hard"==b.effect)&&(b.status="hover",b=A._c.call(this,a.corner,b.opts.cornerSize/2),a.x=b.x,a.y=b.y,A._showFoldedPage.call(this,a,!0)):"hover"==b.status&&(b.status="",A.hideFoldedPage.call(this,!0)))},_eventEnd:function(){var a=this.data().f,b=a.corner;!a.disabled&&b&&"prevented"!=k("released",this,[a.point||b])&&A.hideFoldedPage.call(this,!0),a.corner=null},disable:function(a){return A.setData.call(this,{disabled:a}),this},hover:function(a){return A.setData.call(this,{hover:a}),this},peel:function(b,c){var d=this.data().f;if(b){if(-1==a.inArray(b,u.all))throw l("Corner "+b+" is not permitted");if(-1!=a.inArray(b,A._cAllowed.call(this))){var e=A._c.call(this,b,d.opts.cornerSize/2);d.status="peel",
A._showFoldedPage.call(this,{corner:b,x:e.x,y:e.y},c)}}else d.status="",A.hideFoldedPage.call(this,c);return this}};window.requestAnim=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)},a.extend(a.fn,{flip:function(){return b(a(this[0]),A,arguments)},turn:function(){return b(a(this[0]),z,arguments)},transform:function(a,b){var c={};return b&&(c[p+"transform-origin"]=b),c[p+"transform"]=a,this.css(c)},animatef:function(b){var c=this.data();if(c.effect&&c.effect.stop(),b){b.to.length||(b.to=[b.to]),b.from.length||(b.from=[b.from]);for(var d=[],e=b.to.length,f=!0,g=this,h=(new Date).getTime(),i=function(){if(c.effect&&f){for(var a=[],j=Math.min(b.duration,(new Date).getTime()-h),k=0;e>k;k++)a.push(c.effect.easing(1,j,b.from[k],d[k],b.duration));b.frame(1==e?a[0]:a),j==b.duration?(delete c.effect,g.data(c),b.complete&&b.complete()):window.requestAnim(i)}},j=0;e>j;j++)d.push(b.to[j]-b.from[j]);c.effect=a.extend({stop:function(){f=!1},easing:function(a,b,c,d,e){return d*Math.sqrt(1-(b=b/e-1)*b)+c}},b),this.data(c),i()}else delete c.effect}}),a.isTouch=s,a.mouseEvents=t,a.cssPrefix=i,a.cssTransitionEnd=function(){var a,b=document.createElement("fakeelement"),c={transition:"transitionend",OTransition:"oTransitionEnd",MSTransition:"transitionend",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(a in c)if(void 0!==b.style[a])return c[a]},a.findPos=m}(jQuery);