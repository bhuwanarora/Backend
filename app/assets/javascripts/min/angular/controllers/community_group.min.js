homeApp.service("newsService",["$http","$q","$rootScope","WebsiteUIConstants",function(a,b,c,d){this.get_news_info=function(c,d){return angular.isDefined(d)&&""!=d?_deferred_request("/api/v0/news_info?id="+c+"&tag_id="+d,b,a):_deferred_request("/api/v0/news_info?id="+c,b,a)},this.get_chronological_news=function(c){return _deferred_request("/api/v0/chronological_news?id="+c,b,a)},this.get_community_details=function(c){return _deferred_request("/api/v0/basic_community_info?id="+c,b,a)},this.get_metadata=function(c){return _deferred_request("/api/v0/metadata?url="+c,b,a)},this.get_detailed_community_info=function(c){return _deferred_request("/api/v0/detailed_community_info?id="+c,b,a)},this.follow=function(c,d){return _deferred_request("/api/v0/follow_community?id="+c+"&status="+d,b,a)},this.get_feed_info=function(c){return _deferred_request("/api/v0/feed_community_info?id="+c,b,a)}}]);;homeApp.controller("communityController",["$scope","newsService","$rootScope","ColorConstants","$timeout","$location","$mdDialog","userService","$mdSidenav","sharedService",function(a,b,c,d,e,f,g,h,i,j){a.get_detailed_community_info=function(){b.get_detailed_community_info(a.active_tag.id).then(function(b){a.active_tag=angular.extend(a.active_tag,b);var c=a.active_tag.follow_node;angular.isDefined(c)&&null!=c&&(a.active_tag.status=!0)})},a.goto_news_page=function(a,b){h.news_visited(a),deleteCookie("active_community"),angular.isDefined(b)&&setCookie("active_community",b,1),window.location.href="/news?q="+a},a.show_book_dialog=function(b,d){j.show_book_dialog(c,a,b,d)},a.toggle_follow=function(){angular.isDefined(a.active_tag)?(a.active_tag.status=!a.active_tag.status,b.follow(a.active_tag.id,a.active_tag.status)):i("signup").toggle()},a.refresh_data=function(){b.get_community_details(a.active_tag.id).then(function(b){a.active_tag=angular.extend(a.active_tag,b[0].most_important_tag[0]),angular.forEach(a.active_tag.books,function(b){var c=Math.floor(Math.random()*d.value.length),e=d.value[c];b.color=e,a.info.loading=!1})})};(function(){var b=/[?&]([^=#]+)=([^&#]*)/g,c=b.exec(f.absUrl());if(null!=c){a.info.loading=!0;var d=c[2];a.active_tag={id:d},a.get_detailed_community_info(),e(function(){a.refresh_data()},2e3)}else alert("Bad url")})()}]);