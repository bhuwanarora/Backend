homeApp.service("timeGroupService",["$http","$q","$rootScope","WebsiteUIConstants",function(a,b,c){this.get_time_groups=function(){return _deferred_request("/api/v0/times",b,a)}}]);;homeApp.service("readingTimeService",["$http","$q","$rootScope","WebsiteUIConstants",function(a,b,c){this.get_read_times=function(){return _deferred_request("/api/v0/read_times",b,a)}}]);;homeApp.controller("libraryController",["$scope","$rootScope","$timeout","WebsiteUIConstants","SearchUIConstants","bookService","$routeParams","$location","ColorConstants","$mdToast","infinityService","$mdBottomSheet","$mdSidenav","sharedService","$cookieStore","$mdDialog",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){a.get_popular_books=function(){Object.keys(b.filters).length>0?n.filtered_books(a):n.get_popular_books(a)},a.init_book=function(b){var c=a.info.books[b];f.get_basic_details(c).then(function(c){a.info.books[b]=angular.extend(a.info.books[b],c)})},a.ungroup=function(){a.info.author_filter=!1,a.info.group_by_alphabet=!1,a.info.reading_time_filter=!1,a.info.published_era_filter=!1,a.info.subject_filter=!1},a.group_by_author=function(){a.info.author_filter=!0,a.info.group_by_alphabet=!1,a.info.reading_time_filter=!1,a.info.published_era_filter=!1,a.info.subject_filter=!1},a.group_by_alphabet=function(){a.info.author_filter=!1,a.info.group_by_alphabet=!0,a.info.reading_time_filter=!1,a.info.published_era_filter=!1,a.info.subject_filter=!1},a.group_by_reading_time=function(){a.info.author_filter=!1,a.info.group_by_alphabet=!1,a.info.reading_time_filter=!0,a.info.published_era_filter=!1,a.info.subject_filter=!1},a.group_by_published_era=function(){a.info.author_filter=!1,a.info.group_by_alphabet=!1,a.info.reading_time_filter=!1,a.info.published_era_filter=!0,a.info.subject_filter=!1},a.group_by_subject=function(){a.info.author_filter=!1,a.info.group_by_alphabet=!1,a.info.reading_time_filter=!1,a.info.published_era_filter=!1,a.info.subject_filter=!0},a.select_read_time=function(){delete a.info.books,a.info.custom_loading=!0},a.select_genre=function(b){delete a.info.books,a.info.custom_loading=!0,a.filters.other=angular.extend(a.filters.other,{genre:b.id}),a._get_popular_books()},a.select_author=function(){delete a.info.books,a.info.custom_loading=!0},a.select_time_group=function(){delete a.info.books,a.info.custom_loading=!0},a._get_popular_books=function(){n.load_popular_books(a)},a.show_grid=function(){a.constant.show_book&&(a.grid_style={height:"initial","padding-bottom":"100px"},a.constant={show_book:!1})},a.show_book=function(c,d){a.grid_style={height:"35px","overflow-y":"hidden","padding-bottom":"0px"},a.constant={show_book:!0},b.active_book=d,c.stopPropagation()};a.show_right_nav=function(a){m("alphabets_sidenav").toggle(),a.stopPropagation()},a.show_left_nav=function(a){m("sort_by_sidenav").toggle(),a.stopPropagation()},a.show_bottom_filters=function(b){l.show({templateUrl:"/assets/angular/html/library/bottom_sheet_filters.html",targetEvent:b,scope:a,preserveScope:!0,controller:"filtersController"})};!function(){a.$routeParams=g,a.filters={other:{}},a.grid={},a.info.books=[],a.search_tag={},a.active_tab={},a.info.categories=[],a.friends=[],a.active_endorse=!1,a.active_bookmark=!0,a.active_share=!0,a._get_popular_books(),a.constant={show_book:!1}}()}]);;homeApp.controller("filtersController",["$scope","$rootScope","$timeout","genreService","authorService","WebsiteUIConstants","SearchUIConstants","timeGroupService","readingTimeService","infinityService","ColorConstants","sharedService","$mdBottomSheet",function(a,b,c,d,e,f,g,h,i,j,k,l,m){a._get_genres=function(){(angular.isUndefined(a.info.genres)||0==a.info.genres.length)&&(a.info.genres=[],d.get_genres().then(function(b){angular.forEach(b,function(a){var b=null!=a.status,c=angular.extend(a,{status:b});this.push(c)},a.info.genres)}))},a.close_filters=function(){m.hide()},a._get_authors=function(){a.info.authors=[];var b=0;e.get_popular_authors(b).then(function(b){angular.forEach(b,function(a){this.push(a)},a.info.authors)})},a.reset_filter=function(){delete a.info.selected_genre,delete a.info.selected_author,delete a.info.selected_year,delete a.info.selected_duration,delete a.search_tag.genre,delete a.search_tag.time_group,delete a.search_tag.author,delete a.search_tag.read_time,b.filters={},n()};var n=function(){a.info.infinity=!0,0==Object.keys(b.filters).length?(a.info.books=[],l.get_popular_books(a)):(a.info.books=[],l.filtered_books(a))},o=function(){b.filters.skip_count;delete b.filters.skip_count,delete a.info.other_info,a.info.books=[],Object.keys(b.filters).length>0?n():l.get_popular_books(a)};a.select_genre=function(a){angular.isUndefined(a)?(delete b.filters.category_id,o()):(b.filters.category_id=a.id,n())},a.select_author=function(a){a&&(angular.isUndefined(a)?(delete b.filters.author_id,o()):(b.filters.author_id=a.id,n()))},a.select_reading_time=function(a){angular.isUndefined(a)?(delete b.filters.reading_time_id,o()):(b.filters.reading_time_id=a.id,n())},a.select_publishing_year=function(a){angular.isUndefined(a)?(delete b.filters.era_id,o()):(b.filters.era_id=a.id,n())},a.search_genres=function(b){b?a.info.loading||(a.info.loading=!0,d.search_genres(b).then(function(b){a.info.loading=!1,b.length>0&&(a.info.genres=[],angular.forEach(b,function(a){var b={type:g.Genre,custom_option:!0,icon2:"icon-tag",name:a.category_name,id:a.category_id};this.push(b)},a.info.genres))})):(a.info.loading=!0,(angular.isUndefined(a.info.genres)||0==a.info.genres.length)&&d.get_genres().then(function(b){a.info.genres=[],angular.forEach(b,function(a){var b={name:a.root_category_name,id:a.root_category_id};this.push(b)},a.info.genres),a.info.loading=!1}))},a.search_reading_time=function(){a.info.loading=!0,a.search_tag.read_time=""},a.search_publishing_year=function(){},a.search_authors=function(b){a.info.loading||(a.info.loading=!0,e.search_authors(b).then(function(b){a.info.loading=!1,b.length>0&&(a.info.authors=[],angular.forEach(b,function(a){var b={icon2:"icon-pen",type:g.AuthorSearch,custom_option:!0};b=angular.extend(b,a),this.push(b)},a.info.authors))}))},a._get_time_groups=function(){h.get_time_groups().then(function(b){a.info.time_groups=[],angular.forEach(b,function(a){var b={icon2:"icon-calendar",type:g.Year,custom_option:!0};b=angular.extend(b,a),this.push(b)},a.info.time_groups)})},a._get_reading_times=function(){i.get_read_times().then(function(b){a.info.read_times=[],angular.forEach(b,function(a){var b={icon2:"icon-clock",type:g.Time,custom_option:!0};b=angular.extend(b,a),this.push(b)},a.info.read_times)})},a._detect_key=function(a){var b=a.keyCode==f.Backspace||a.keyCode==f.Delete,c=a.keyCode==f.KeyUp,d=a.keyCode==f.KeyDown,e=a.keyCode==f.KeyLeft,g=a.keyCode==f.KeyRight,h=a.keyCode==f.Enter;return{backspace_or_delete:b,keyUp:c,keyDown:d,keyLeft:e,keyRight:g,keyEnter:h}};!function(){a.search_tag={},a.info.genres=[],a.info.authors=[],a.info.time_groups=[],a.info.read_times=[],a._get_time_groups(),a._get_reading_times(),angular.isUndefined(b.filters)&&(b.filters={})}()}]);